---
import LayerDiagram from './LayerDiagram.vue';
---

<section class="bg-bg-secondary" id="architecture">
  <div class="max-w-5xl mx-auto px-6">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-text-primary mb-4">Architecture</h2>
      <p class="text-text-secondary max-w-2xl mx-auto">
        Strict Domain-Driven Design with hexagonal architecture.
        Dependencies point inward &mdash; the domain has zero external dependencies.
      </p>
    </div>

    <div class="grid lg:grid-cols-2 gap-8 items-start">
      <!-- Layer diagram -->
      <div>
        <h3 class="text-lg font-semibold text-text-primary mb-4">DDD Layers</h3>
        <LayerDiagram client:visible />
      </div>

      <!-- Decorator chain + key libraries -->
      <div>
        <h3 class="text-lg font-semibold text-text-primary mb-4">Decorator Chain</h3>

        <!-- Read chain -->
        <div class="mb-4">
          <span class="text-xs font-semibold text-accent uppercase tracking-wider mb-2 block">Read Path</span>
          <div class="flex flex-wrap items-center gap-2 text-sm font-mono">
            <span class="px-2.5 py-1 rounded bg-accent/10 text-accent border border-accent/20">Granola API</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-red/10 text-red border border-red/20">Resilient</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-cyan/10 text-cyan border border-cyan/20">Cached</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-accent-secondary/10 text-accent-secondary border border-accent-secondary/20">Use Cases</span>
          </div>
        </div>

        <!-- Write chain -->
        <div class="mb-6">
          <span class="text-xs font-semibold text-green uppercase tracking-wider mb-2 block">Write Path</span>
          <div class="flex flex-wrap items-center gap-2 text-sm font-mono">
            <span class="px-2.5 py-1 rounded bg-green/10 text-green border border-green/20">Use Cases</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-cyan/10 text-cyan border border-cyan/20">Local Store</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-accent-secondary/10 text-accent-secondary border border-accent-secondary/20">Outbox</span>
            <span class="text-text-muted">→</span>
            <span class="px-2.5 py-1 rounded bg-accent/10 text-accent border border-accent/20">Events</span>
          </div>
        </div>

        <!-- Key libraries -->
        <h3 class="text-lg font-semibold text-text-primary mb-4">Key Libraries</h3>
        <div class="space-y-3">
          <div class="flex items-start gap-3">
            <span class="px-2 py-0.5 rounded bg-accent/10 text-accent text-xs font-mono border border-accent/20 whitespace-nowrap mt-0.5">mcp-go</span>
            <span class="text-sm text-text-secondary">MCP server framework with typed tools, resources, and multi-transport</span>
          </div>
          <div class="flex items-start gap-3">
            <span class="px-2 py-0.5 rounded bg-red/10 text-red text-xs font-mono border border-red/20 whitespace-nowrap mt-0.5">fortify</span>
            <span class="text-sm text-text-secondary">Circuit breaker, retry, rate limit, timeout</span>
          </div>
          <div class="flex items-start gap-3">
            <span class="px-2 py-0.5 rounded bg-accent-secondary/10 text-accent-secondary text-xs font-mono border border-accent-secondary/20 whitespace-nowrap mt-0.5">cobra</span>
            <span class="text-sm text-text-secondary">CLI framework for terminal commands</span>
          </div>
          <div class="flex items-start gap-3">
            <span class="px-2 py-0.5 rounded bg-cyan/10 text-cyan text-xs font-mono border border-cyan/20 whitespace-nowrap mt-0.5">go-sqlite3</span>
            <span class="text-sm text-text-secondary">SQLite driver for local cache and store</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
